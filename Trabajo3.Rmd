---
title: "Trabajo 3"
author: "Nuria Rodríguez Barroso"
date: "17 de mayo de 2017"
output: pdf_document
---

```{r echo = FALSE}
    #Fijamos la semilla para obtener siempre los mismos resultados
    set.seed(123456789)
```

#Clasificación.

```{r echo = FALSE}
  
    sahd <- read.table("./data/SAHD", sep=",",head=T, row.names = 1)
    summary(sahd)
    
    train <- sample(nrow(sahd), 0.7*nrow(sahd))
    sahd_train <- sahd[train,-ncol(sahd)]
    sahd_label <- sahd[, ncol(sahd)]
    sahd_test <- sahd[-train,-ncol(sahd)]
    sahd_label_test <- sahd[-train, ncol(sahd)

    attach(sahd)
    pairs(~ sbp + tobacco + ldl + adiposity + famhist + typea + obesity + alcohol + age, data= sahd, col = chd+3)

    #Regresión logística
    ml1 = glm(sahd_label ~ tobacco + ldl,family = binomial(logit), data = sahd[,-ncol(sahd)], subset=train)
    summary(ml1)
    
    #Cálculo de probabilidades
    prob_train_ml1 = predict(ml1, type = "response")
    prob_test_ml1 = predict(ml1, sahd_test, type="response")
    
    #Veamos cómo predice 
    pred_test_ml1 = rep(0, length(prob_test_ml1)) # predicciones por defecto 0
    pred_test_ml1[prob_test_ml1 >=0.5] = 1 # >= 0.5 clase 1
    table(pred_test_ml1, sahd_test) 
    
```
